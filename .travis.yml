language: node_js
node_js:
- 11.10.1
python:
- '3.6'
cache:
- pip
addons:
  apt:
    packages:
    - nodejs-legacy
branches:
  only:
  - master
  - "/^greenkeeper/.*$/"
stages:
- test
before_install:
- pip install --user awscli
- export PATH=$PATH:$HOME/.local/bin
install:
- npm i
jobs:
  include:
  - stage: test
    name: Lint
    script: npm run lint
  - stage: test
    name: Unit test
    script: npm test
    after_success:
      - cat ./dist/coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js
deploy:
- provider: npm
  email: willem_liu@hotmail.com
  on:
    branch: master
  api_key:
    secure: GUBM7KjqfUTHu+jBo31vm0SJw5S8T89oy4iPE6Y43n2zM941+TG2MNGG121+ZK4qY4t+EYsuLHwzk2u7pZF9FK1ekP9PXJOXr58fgI/izexkheKd7O7xZw9THN8JnWIuV2LpQnIktpognAY6XaR7Fwyn5CfVqsadUeN8MUxvw9fJASYXwEOpS9dTb0qte2JXZnSRVs54GU36y8k8ts6tPyeceajkKgB5DIQKX1PX8X5RQqcZNgiaBNBvflGWCiCeg2pBipyZ4PtspuNRVif16+TciWeCDSSR+BH2csaHr3L6AYNtZu2ECvIDJuVkEs4obNG8MrvfYE8WvF0Wn2iJ6PBmOjApqMVKPj473mrPQxIrJC8ffh8QZyIkfzDquTjM5zqRpUth2Z8YmZis6Kp5TLwDSyOhHfQXxSG5YtUHLiSxAwZY/F91/Z07COYTATAU57vxWD8Yz8JG67ocrVwQTQ7QOPpEH8qGBAp038k8LxCHbE7oGqBCX6J+XfOw+MmTVSeuBMTl7oWeSRKgYwKcEQRgo35V0kvMqqXxP2/zgqIr0zf/I+qj8Vl+rtikE0w7HnNZzatBzRCMOsd/Mv+SVkP2Zvc0S5SRNsFlDjSf4+dqZBjC9lngGfSeMvd4I20vcUBJddBrKtEIjTf+GPsYIxLj0oMz4ZEu6rDA8Aw1EQo=
notifications:
  webhooks: https://outlook.office.com/webhook/09d65d9c-ba4d-4ce4-8ff9-985e1ea578a1@8f2a0bdd-25fe-430a-adb5-0d2367dd50ee/TravisCI/308b447ae6eb4c3f9c7e153e97a4bd25/aaeb5e7b-fe7b-4d97-9adf-3089c10da2cc
  on_success: change
